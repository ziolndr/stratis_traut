<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ARBITER ‚Ä¢ Semantic Intelligence</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    :root {
      --bg-primary: #09090b;
      --bg-secondary: #18181b;
      --bg-tertiary: #27272a;
      --border: rgba(255,255,255,0.08);
      --border-hover: rgba(255,255,255,0.15);
      --text-primary: #fafafa;
      --text-secondary: #a1a1aa;
      --text-muted: #71717a;
      --accent-blue: #3b82f6;
      --accent-purple: #8b5cf6;
      --accent-emerald: #10b981;
      --accent-amber: #f59e0b;
      --accent-rose: #f43f5e;
      --glow-blue: rgba(59, 130, 246, 0.5);
      --glow-purple: rgba(139, 92, 246, 0.5);
    }
    
    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--bg-tertiary); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #3f3f46; }
    
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    @keyframes glow {
      0%, 100% { box-shadow: 0 0 20px var(--glow-blue); }
      50% { box-shadow: 0 0 40px var(--glow-purple); }
    }
    
    @keyframes scoreReveal {
      0% { width: 0%; opacity: 0; }
      100% { opacity: 1; }
    }
    
    .fade-in { animation: fadeIn 0.4s ease-out forwards; }
    .fade-in-delay-1 { animation-delay: 0.1s; opacity: 0; }
    .fade-in-delay-2 { animation-delay: 0.2s; opacity: 0; }
    .fade-in-delay-3 { animation-delay: 0.3s; opacity: 0; }
    
    /* Glass morphism */
    .glass {
      background: rgba(24, 24, 27, 0.8);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--border);
    }
    
    .glass-hover:hover {
      border-color: var(--border-hover);
      background: rgba(39, 39, 42, 0.8);
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;
    
    // Production: runs local. Demo: remote endpoint for demonstration.
    const ARBITER_API = 'https://api.arbiter.traut.ai/public/compare';

    // Intelligence corpus - the exact signals that created the magic moments
    const INTELLIGENCE_CORPUS = [
      {
        id: 'HUMINT-001',
        timestamp: '2024-12-10T21:30:00Z',
        source: 'HUMINT',
        classification: 'SECRET',
        content: 'Soldiers observed drinking heavily in border town bars, speaking of goodbyes to families. Multiple witnesses report emotional farewells and fatalistic talk. Pattern consistent with personnel expecting imminent deployment to combat.',
        region: 'Border Region'
      },
      {
        id: 'HUMINT-002',
        timestamp: '2024-12-10T14:15:00Z',
        source: 'HUMINT',
        classification: 'CONFIDENTIAL',
        content: 'Grandson called grandmother unexpectedly from military base. Conversation described as emotional. He asked her to "take care of the family garden" - phrase previously used before 2014 deployment. Source is 73-year-old resident of border village.',
        region: 'Eastern District'
      },
      {
        id: 'ENVIRO-003',
        timestamp: '2024-12-11T06:00:00Z',
        source: 'MASINT',
        classification: 'SECRET',
        content: 'Fish behavior anomalies detected in border river. Schools moving away from northern banks. Local fishermen report catches down 80% in past 72 hours. Pattern preceded ground operations in 2014 by approximately 96 hours.',
        region: 'River Corridor'
      },
      {
        id: 'HUMINT-004',
        timestamp: '2024-12-10T11:00:00Z',
        source: 'HUMINT',
        classification: 'CONFIDENTIAL',
        content: 'Children being evacuated from border village schools mid-term. Parents arriving with vehicles packed with belongings. Teachers instructed to release students without explanation. Similar pattern observed in three adjacent villages.',
        region: 'Border Region'
      },
      {
        id: 'HUMINT-005',
        timestamp: '2024-12-10T18:00:00Z',
        source: 'HUMINT',
        classification: 'CONFIDENTIAL',
        content: 'Local priest held special confession services. Church remained open until midnight. Elderly parishioners describe atmosphere as "like before the last war." Priest declined to comment but was observed blessing military-age men.',
        region: 'Border Region'
      },
      {
        id: 'ENVIRO-006',
        timestamp: '2024-12-11T04:30:00Z',
        source: 'HUMINT',
        classification: 'UNCLASSIFIED',
        content: 'Stray dogs observed fleeing border areas in unusual numbers. Animal shelter in nearby town reports 300% increase in strays arriving from east. Local veterinarian notes animals appear stressed, disoriented. Pattern not explained by weather or food availability.',
        region: 'Border Region'
      },
      {
        id: 'OSINT-007',
        timestamp: '2024-12-10T16:00:00Z',
        source: 'OSINT',
        classification: 'UNCLASSIFIED',
        content: 'Wedding cancellations spike 400% in border district. Venues report mass postponements citing "family circumstances." Florists and caterers confirm sudden order cancellations. Pattern concentrated in military family demographics.',
        region: 'Multiple Districts'
      },
      {
        id: 'HUMINT-008',
        timestamp: '2024-12-11T08:00:00Z',
        source: 'HUMINT',
        classification: 'CONFIDENTIAL',
        content: 'Street vendors disappearing from border town markets. Stalls that operated for years now empty. Remaining vendors report others left "to be with family." Market activity down 60% despite no official warnings.',
        region: 'Border Region'
      },
      {
        id: 'OSINT-009',
        timestamp: '2024-12-10T22:00:00Z',
        source: 'OSINT',
        classification: 'UNCLASSIFIED',
        content: 'Military families posting farewell messages on social media. Geolocated to garrison towns. Posts reference "praying for safe return" and "until we meet again." Engagement patterns suggest genuine emotional content, not coordinated messaging.',
        region: 'Central Region'
      },
      {
        id: 'HUMINT-010',
        timestamp: '2024-12-11T09:00:00Z',
        source: 'HUMINT',
        classification: 'SECRET',
        content: 'Pharmacy run on trauma supplies in border towns. Bandages, tourniquets, blood clotting agents sold out across 12 locations. Purchases made by individuals, not institutions. Pattern suggests population-level anticipatory behavior.',
        region: 'Border Region'
      },
      {
        id: 'SIGINT-011',
        timestamp: '2024-12-11T02:00:00Z',
        source: 'SIGINT',
        classification: 'TOP SECRET',
        content: 'GPS jamming detected across 200km front. Jamming intensity increased 400% over 48 hours. Pattern consistent with pre-operational electronic warfare preparation. Civilian navigation systems affected in border zone.',
        region: 'Border Region'
      },
      {
        id: 'SIGINT-012',
        timestamp: '2024-12-11T00:00:00Z',
        source: 'SIGINT',
        classification: 'TOP SECRET',
        content: 'Encrypted radio traffic tripled on military command networks. New callsigns detected not matching any known unit designations. Frequency hopping patterns shifted from training protocols to operational configurations.',
        region: 'Multiple Sectors'
      },
      {
        id: 'SIGINT-013',
        timestamp: '2024-12-11T03:00:00Z',
        source: 'SIGINT',
        classification: 'TOP SECRET',
        content: 'Unusual silence on military frequencies normally active. Routine traffic ceased at 0200 hours. Pattern consistent with communications blackout preceding operations. Similar signature observed 72 hours before previous offensive.',
        region: 'Northern Sector'
      },
      {
        id: 'TECHINT-014',
        timestamp: '2024-12-10T20:00:00Z',
        source: 'TECHINT',
        classification: 'SECRET',
        content: 'Electricity consumption patterns show 24-hour activity at forward bases. Facilities normally dark 2200-0600 now show continuous power draw. Thermal signatures indicate vehicle maintenance and equipment preparation.',
        region: 'Forward Positions'
      },
      {
        id: 'SATINT-015',
        timestamp: '2024-12-11T10:00:00Z',
        source: 'SATINT',
        classification: 'SECRET',
        content: 'Satellite imagery confirms evacuation buses staged in Crimean towns near Kerch bridge. 47 buses identified, civilian markings. Positioned at schools and community centers. No public evacuation announced.',
        region: 'Crimea'
      },
      {
        id: 'HUMINT-016',
        timestamp: '2024-12-10T12:00:00Z',
        source: 'HUMINT',
        classification: 'SECRET',
        content: 'Russian VIPs evacuating families from Crimea. Private aircraft departures from Simferopol increased 600%. Destination primarily Moscow and Dubai. Evacuees include regional administration families and business elites.',
        region: 'Crimea'
      },
      {
        id: 'OSINT-017',
        timestamp: '2024-12-11T07:00:00Z',
        source: 'OSINT',
        classification: 'UNCLASSIFIED',
        content: 'Russian state media amplifying nuclear rhetoric. Coverage of tactical nuclear capabilities increased 300%. Messaging emphasizes "all options" for defending territorial integrity. Pattern suggests information preparation for escalation.',
        region: 'Media Environment'
      },
      {
        id: 'FININT-018',
        timestamp: '2024-12-10T15:00:00Z',
        source: 'FININT',
        classification: 'SECRET',
        content: 'Chinese satellite tasking surge detected over Black Sea region. Commercial imagery purchases increased 800% from baseline. Requests concentrated on port facilities and bridge infrastructure. Buyer analysis indicates state-affiliated entities.',
        region: 'Black Sea'
      },
      {
        id: 'HUMINT-019',
        timestamp: '2024-12-11T11:00:00Z',
        source: 'HUMINT',
        classification: 'SECRET',
        content: 'Partisan activity reported along Crimean supply routes. Three incidents of rail disruption in 48 hours. Pattern suggests coordinated harassment of logistics. Russian response indicates concern about sustainment vulnerability.',
        region: 'Crimea Approaches'
      },
      {
        id: 'ENVIRO-020',
        timestamp: '2024-12-11T05:00:00Z',
        source: 'MASINT',
        classification: 'CONFIDENTIAL',
        content: 'Migratory birds altering flight patterns over border zone. Flocks observed diverting around areas with no visible obstruction. Wildlife biologists note pattern inconsistent with normal seasonal behavior. Similar deviation preceded 2022 incursion.',
        region: 'Border Airspace'
      },
      {
        id: 'HUMINT-021',
        timestamp: '2024-12-10T19:00:00Z',
        source: 'HUMINT',
        classification: 'CONFIDENTIAL',
        content: 'Border crossing wait times dropped to zero. Normally 2-3 hour delays now processed immediately. Guards appear distracted, minimal inspection. Local interpretation: "They know something is coming and do not care about smuggling today."',
        region: 'Border Crossing'
      },
      {
        id: 'GEOINT-022',
        timestamp: '2024-12-11T08:30:00Z',
        source: 'GEOINT',
        classification: 'SECRET',
        content: 'Ground vibration sensors detect heavy vehicle movement at night. Seismic signature consistent with armored column. Movement pattern suggests staging at tree lines and covered positions. Activity ceased before dawn.',
        region: 'Northern Sector'
      },
      {
        id: 'HUMINT-023',
        timestamp: '2024-12-10T13:00:00Z',
        source: 'HUMINT',
        classification: 'SECRET',
        content: 'Field hospital procurement surge detected. Blood products, surgical supplies, body bags ordered in quantities 500% above baseline. Delivery locations consistent with forward medical staging. No training exercise announced.',
        region: 'Rear Areas'
      },
      {
        id: 'SIGINT-024',
        timestamp: '2024-12-11T01:00:00Z',
        source: 'SIGINT',
        classification: 'TOP SECRET',
        content: 'Cell tower coverage shifted along border. New temporary towers activated in forest areas. Pattern provides coverage for assembly areas not served by existing infrastructure. Similar preparation observed before previous operations.',
        region: 'Border Region'
      },
      {
        id: 'HUMINT-025',
        timestamp: '2024-12-10T17:00:00Z',
        source: 'HUMINT',
        classification: 'CONFIDENTIAL',
        content: 'Conscript leave cancellations reported across multiple units. Personnel told to "remain available." Families report soldiers unable to attend planned events. Pattern affects units in forward positions disproportionately.',
        region: 'Multiple Units'
      },
      {
        id: 'OSINT-026',
        timestamp: '2024-12-11T12:00:00Z',
        source: 'OSINT',
        classification: 'UNCLASSIFIED',
        content: 'Social media posts from military personnel suddenly ceased. Accounts that posted daily now silent for 72+ hours. No farewell posts, no explanations. Pattern affects personnel in forward-deployed units. Digital silence preceded physical movement in previous operations.',
        region: 'Digital Environment'
      },
      {
        id: 'OSINT-027',
        timestamp: '2024-12-11T13:00:00Z',
        source: 'OSINT',
        classification: 'UNCLASSIFIED',
        content: 'Military families stopped posting on social networks. Spouse groups that shared daily updates now inactive. Pattern shifted from sharing to silence within 48-hour window. No official communication requesting operational security.',
        region: 'Digital Environment'
      },
      {
        id: 'OSINT-028',
        timestamp: '2024-12-11T14:00:00Z',
        source: 'OSINT',
        classification: 'UNCLASSIFIED',
        content: 'Troop rotation announcements normally published weekly went silent. Defense ministry website shows no updates for 9 days. Press office not responding to routine inquiries. Pattern unprecedented in 18-month observation baseline.',
        region: 'Official Communications'
      },
      {
        id: 'OSINT-029',
        timestamp: '2024-12-11T15:00:00Z',
        source: 'OSINT',
        classification: 'UNCLASSIFIED',
        content: 'Defense ministry spokesperson availability reduced to zero. Previously held daily briefings, now cancelled indefinitely citing "scheduling." Journalists report all requests for comment unanswered. Information vacuum emerging.',
        region: 'Official Communications'
      },
      {
        id: 'TECHINT-030',
        timestamp: '2024-12-11T16:00:00Z',
        source: 'TECHINT',
        classification: 'SECRET',
        content: 'Flight tracking data gaps appear over military airfields. ADS-B coverage shows aircraft disappearing from tracking near bases. Pattern consistent with transponder deactivation or jamming. Commercial flights rerouting around affected areas without explanation.',
        region: 'Airspace'
      }
    ];

    // Perspective personas - the exact observers that created magic moments
    const PERSONAS = [
      {
        id: 'journalist',
        name: 'War Correspondent',
        icon: 'üì∞',
        description: 'Finds the human story that leads the broadcast',
        query: 'As a war correspondent looking for the emotional truth of what is happening, what details would I lead my story with? What moments capture the human experience of war approaching?'
      },
      {
        id: 'babusya',
        name: 'Babusya (Grandmother)',
        icon: 'üëµ',
        description: 'Survived the last war. Knows the signs.',
        query: 'As an elderly grandmother in a border village who survived previous wars, what signs would tell me it is time to take my grandchildren and leave? What would I notice that officials would not announce?'
      },
      {
        id: 'analyst',
        name: 'Military Intelligence Analyst',
        icon: 'üéñÔ∏è',
        description: 'Tracks operational indicators and warnings',
        query: 'As a military intelligence analyst tracking indicators and warnings, what signals demand immediate attention? What patterns suggest transition from posture to action?'
      },
      {
        id: 'silence',
        name: 'The Silence',
        icon: 'üï≥Ô∏è',
        description: 'Finds what is NOT happening. The gaps. The absences.',
        query: 'What is conspicuously absent? What normally happens that has stopped? What voices have gone quiet? What data has gaps? What routines have broken? The silence before the storm - what is NOT happening that should be?'
      },
      {
        id: 'humanitarian',
        name: 'Humanitarian Coordinator',
        icon: 'üè•',
        description: 'Must position resources before displacement begins',
        query: 'As a humanitarian aid coordinator who must pre-position resources, what signals indicate civilian displacement is imminent? What would tell me to activate emergency protocols?'
      },
      {
        id: 'land',
        name: 'The Land Itself',
        icon: 'üåç',
        description: 'The rivers, animals, earth feel what humans ignore',
        query: 'As the land itself - the rivers, the soil, the animals, the air - what disturbances do I feel in my body? What is different in the fish, the birds, the dogs? What trembles that should be still?'
      },
      {
        id: 'zelensky',
        name: 'President Zelensky',
        icon: 'üá∫üá¶',
        description: 'Must know what his people face today',
        query: 'As President Zelensky needing to understand what my people face, what would tell me if my citizens will see war today? What signals speak to the human cost my nation is about to bear?'
      },
      {
        id: 'russian_commander',
        name: 'Russian Commander',
        icon: '‚öîÔ∏è',
        description: 'Needs to know if preparations have been detected',
        query: 'As the Russian commander responsible for this operation, what signals would tell me my preparations have been detected? What would indicate the enemy knows we are coming?'
      }
    ];

    // World hypotheses - the 6 competing realities
    const HYPOTHESES = [
      {
        id: 'kerch',
        name: 'Kerch Vulnerability',
        color: '#f43f5e',
        query: 'In a world where Ukraine is about to destroy the Kerch Bridge, what signals would we observe? Evacuation preparations in Crimea, VIP families leaving, partisan activity on supply routes, Chinese intelligence interest in bridge infrastructure, Russian defensive repositioning.'
      },
      {
        id: 'zaporizhzhia',
        name: 'Zaporizhzhia Seizure',
        color: '#f59e0b',
        query: 'In a world where Russia\'s true objective is seizing the Zaporizhzhia nuclear plant, what signals would cohere? Nuclear rhetoric amplification, specialized unit movements, IAEA communication patterns, evacuation corridors being established, radiation monitoring changes.'
      },
      {
        id: 'crimea_collapse',
        name: 'Crimea Collapse',
        color: '#3b82f6',
        query: 'In a world where Russian leadership has secretly concluded Crimea is lost, what would we observe? Elite family evacuations, asset transfers, supply route hardening, defensive repositioning, propaganda preparing domestic audience for withdrawal.'
      },
      {
        id: 'moldova',
        name: 'Moldova Gambit',
        color: '#8b5cf6',
        query: 'In a world where Russia is preparing a second front through Transnistria into Moldova, what signals would appear? Transnistria garrison activation, Romanian border activity, Moldovan government warnings, NATO eastern flank repositioning, refugee corridor preparation.'
      },
      {
        id: 'maskirovka',
        name: 'Maskirovka (Deception)',
        color: '#10b981',
        query: 'In a world where everything we are observing is deliberate deception to fix our attention while the real operation happens elsewhere, what would cohere? Obvious signals that seem too easy to detect, coordinated media amplification, partisan activity that serves Russian narrative, misdirection patterns.'
      },
      {
        id: 'negotiation',
        name: 'Secret Negotiation',
        color: '#71717a',
        query: 'In a world where backchannel ceasefire negotiations are underway and both sides are posturing for leverage, what would we see? Diplomatic movement, intermediary country activity, military positioning for negotiating advantage rather than combat, media de-escalation signals.'
      }
    ];

    // Main App Component
    function App() {
      const [mode, setMode] = useState(null); // null = home, 'perspective', 'arbitration'
      const [selectedPersona, setSelectedPersona] = useState(null);
      const [results, setResults] = useState([]);
      const [loading, setLoading] = useState(false);
      const [arbitrationResults, setArbitrationResults] = useState(null);

      const runPerspectiveSearch = async (persona) => {
        setSelectedPersona(persona);
        setLoading(true);
        setResults([]);

        try {
          const scored = [];
          for (const doc of INTELLIGENCE_CORPUS) {
            const response = await fetch(ARBITER_API, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                query: persona.query,
                candidates: [doc.content]
              })
            });
            const data = await response.json();
            const score = data.all?.[0]?.score || 0;
            scored.push({ ...doc, score });
          }
          
          scored.sort((a, b) => b.score - a.score);
          setResults(scored);
        } catch (error) {
          console.error('Search failed:', error);
        }
        
        setLoading(false);
      };

      const runWorldArbitration = async () => {
        setLoading(true);
        setArbitrationResults(null);

        try {
          const hypothesisScores = [];
          
          for (const hypothesis of HYPOTHESES) {
            let totalScore = 0;
            const docScores = [];
            
            for (const doc of INTELLIGENCE_CORPUS) {
              const response = await fetch(ARBITER_API, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                  query: hypothesis.query,
                  candidates: [doc.content]
                })
              });
              const data = await response.json();
              const score = data.all?.[0]?.score || 0;
              totalScore += score;
              docScores.push({ doc, score });
            }
            
            const avgScore = totalScore / INTELLIGENCE_CORPUS.length;
            docScores.sort((a, b) => b.score - a.score);
            
            hypothesisScores.push({
              hypothesis,
              avgScore,
              topDocs: docScores.slice(0, 3)
            });
          }
          
          hypothesisScores.sort((a, b) => b.avgScore - a.avgScore);
          
          const winner = hypothesisScores[0];
          const runnerUp = hypothesisScores[1];
          const delta = ((winner.avgScore - runnerUp.avgScore) / runnerUp.avgScore * 100).toFixed(1);
          
          setArbitrationResults({
            hypotheses: hypothesisScores,
            winner,
            runnerUp,
            delta
          });
        } catch (error) {
          console.error('Arbitration failed:', error);
        }
        
        setLoading(false);
      };

      // Home Screen
      if (!mode) {
        return (
          <div style={{
            minHeight: '100vh',
            display: 'flex',
            flexDirection: 'column',
            alignItems: 'center',
            justifyContent: 'center',
            padding: '40px 20px',
            background: 'var(--bg-primary)'
          }}>
            {/* Logo */}
            <div className="fade-in" style={{ textAlign: 'center', marginBottom: '60px' }}>
              <div style={{
                fontSize: '11px',
                letterSpacing: '4px',
                color: '#52525b',
                marginBottom: '20px',
                fontWeight: 500
              }}>
                STRATIS √ó TRAUT
              </div>
              <h1 style={{
                fontSize: '56px',
                fontWeight: 600,
                letterSpacing: '-1px',
                color: '#fafafa',
                marginBottom: '16px'
              }}>
                ARBITER
              </h1>
              <p style={{
                fontSize: '16px',
                color: 'var(--text-muted)',
                maxWidth: '400px',
                lineHeight: 1.6,
                letterSpacing: '0.5px'
              }}>
                Geometric coherence engine for multi-source intelligence resolution
              </p>
            </div>

            {/* Mode Cards */}
            <div style={{
              display: 'grid',
              gridTemplateColumns: 'repeat(2, 1fr)',
              gap: '24px',
              maxWidth: '800px',
              width: '100%'
            }}>
              {/* Perspective Shift Card */}
              <div
                className="glass glass-hover fade-in fade-in-delay-1"
                onClick={() => setMode('perspective')}
                style={{
                  padding: '40px',
                  borderRadius: '16px',
                  cursor: 'pointer',
                  transition: 'all 0.3s ease',
                  position: 'relative',
                  overflow: 'hidden'
                }}
                onMouseEnter={(e) => {
                  e.currentTarget.style.transform = 'translateY(-2px)';
                  e.currentTarget.style.borderColor = 'var(--border-hover)';
                }}
                onMouseLeave={(e) => {
                  e.currentTarget.style.transform = 'translateY(0)';
                  e.currentTarget.style.borderColor = 'var(--border)';
                }}
              >
                <div style={{
                  position: 'absolute',
                  top: 0,
                  left: 0,
                  right: 0,
                  height: '1px',
                  background: 'var(--border-hover)'
                }} />
                <div style={{ fontSize: '32px', marginBottom: '20px', color: 'var(--text-muted)' }}>‚¨°</div>
                <h2 style={{ fontSize: '24px', fontWeight: 600, marginBottom: '12px' }}>
                  Perspective Shift
                </h2>
                <p style={{ color: 'var(--text-secondary)', lineHeight: 1.6, marginBottom: '24px', fontSize: '14px' }}>
                  Same signals. Different observers. Reframe without reprocessing.
                </p>
                <div style={{
                  display: 'inline-flex',
                  alignItems: 'center',
                  gap: '6px',
                  color: 'var(--text-muted)',
                  fontSize: '12px',
                  fontWeight: 400
                }}>
                  Enter ‚Üí
                </div>
              </div>

              {/* World Arbitration Card */}
              <div
                className="glass glass-hover fade-in fade-in-delay-2"
                onClick={() => { setMode('arbitration'); runWorldArbitration(); }}
                style={{
                  padding: '40px',
                  borderRadius: '16px',
                  cursor: 'pointer',
                  transition: 'all 0.3s ease',
                  position: 'relative',
                  overflow: 'hidden'
                }}
                onMouseEnter={(e) => {
                  e.currentTarget.style.transform = 'translateY(-2px)';
                  e.currentTarget.style.borderColor = 'var(--border-hover)';
                }}
                onMouseLeave={(e) => {
                  e.currentTarget.style.transform = 'translateY(0)';
                  e.currentTarget.style.borderColor = 'var(--border)';
                }}
              >
                <div style={{
                  position: 'absolute',
                  top: 0,
                  left: 0,
                  right: 0,
                  height: '1px',
                  background: 'var(--border-hover)'
                }} />
                <div style={{ fontSize: '32px', marginBottom: '20px', color: 'var(--text-muted)' }}>‚óá</div>
                <h2 style={{ fontSize: '24px', fontWeight: 600, marginBottom: '12px' }}>
                  World Arbitration
                </h2>
                <p style={{ color: 'var(--text-secondary)', lineHeight: 1.6, marginBottom: '24px', fontSize: '14px' }}>
                  Competing hypotheses. One reality. Resolve which world the data supports.
                </p>
                <div style={{
                  display: 'inline-flex',
                  alignItems: 'center',
                  gap: '6px',
                  color: 'var(--text-muted)',
                  fontSize: '12px',
                  fontWeight: 400
                }}>
                  Enter ‚Üí
                </div>
              </div>
            </div>

            {/* Engine Status */}
            <div className="fade-in fade-in-delay-3" style={{
              marginTop: '80px',
              textAlign: 'center',
              color: 'var(--text-muted)',
              fontSize: '11px',
              fontFamily: 'JetBrains Mono',
              letterSpacing: '1px'
            }}>
              ENGINE: ARBITER-72D v0.9 ‚Ä¢ LOCAL ‚Ä¢ DETERMINISTIC
            </div>
          </div>
        );
      }

      // Perspective Shift Mode
      if (mode === 'perspective') {
        return (
          <div style={{ minHeight: '100vh', background: 'var(--bg-primary)' }}>
            {/* Header */}
            <header style={{
              padding: '20px 32px',
              borderBottom: '1px solid var(--border)',
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'space-between',
              background: 'rgba(9, 9, 11, 0.8)',
              backdropFilter: 'blur(20px)',
              position: 'sticky',
              top: 0,
              zIndex: 100
            }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                <button
                  onClick={() => { setMode(null); setResults([]); setSelectedPersona(null); }}
                  style={{
                    background: 'none',
                    border: 'none',
                    color: 'var(--text-secondary)',
                    cursor: 'pointer',
                    fontSize: '20px',
                    padding: '8px'
                  }}
                >
                  ‚Üê
                </button>
                <div>
                  <div style={{ fontSize: '12px', color: 'var(--text-muted)', letterSpacing: '2px' }}>
                    MODE 1
                  </div>
                  <div style={{ fontSize: '18px', fontWeight: 600 }}>
                    Perspective Shift
                  </div>
                </div>
              </div>
              <div style={{ 
                fontSize: '11px', 
                color: 'var(--text-muted)', 
                fontFamily: 'JetBrains Mono',
                letterSpacing: '1px'
              }}>
                ARBITER-72D ‚Ä¢ LOCAL
              </div>
            </header>

            <div style={{ display: 'grid', gridTemplateColumns: '320px 1fr', minHeight: 'calc(100vh - 81px)' }}>
              {/* Persona Selector */}
              <div style={{
                borderRight: '1px solid var(--border)',
                padding: '24px',
                background: 'var(--bg-secondary)'
              }}>
                <div style={{
                  fontSize: '11px',
                  letterSpacing: '2px',
                  color: 'var(--text-muted)',
                  marginBottom: '16px'
                }}>
                  SELECT OBSERVER
                </div>
                
                {PERSONAS.map((persona, idx) => (
                  <div
                    key={persona.id}
                    className="fade-in"
                    style={{ animationDelay: `${idx * 0.05}s` }}
                    onClick={() => runPerspectiveSearch(persona)}
                  >
                    <div style={{
                      padding: '16px',
                      borderRadius: '12px',
                      marginBottom: '8px',
                      cursor: 'pointer',
                      border: '1px solid',
                      borderColor: selectedPersona?.id === persona.id ? 'var(--accent-purple)' : 'var(--border)',
                      background: selectedPersona?.id === persona.id ? 'rgba(139, 92, 246, 0.1)' : 'var(--bg-primary)',
                      transition: 'all 0.2s ease'
                    }}>
                      <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' }}>
                        <span style={{ fontSize: '24px' }}>{persona.icon}</span>
                        <span style={{ fontWeight: 500 }}>{persona.name}</span>
                      </div>
                      <div style={{ fontSize: '13px', color: 'var(--text-muted)', lineHeight: 1.5 }}>
                        {persona.description}
                      </div>
                    </div>
                  </div>
                ))}

                {selectedPersona && results.length > 0 && (
                  <div style={{
                    marginTop: '24px',
                    padding: '16px',
                    background: 'var(--bg-primary)',
                    borderRadius: '12px',
                    border: '1px solid var(--border)'
                  }}>
                    <div style={{ fontSize: '11px', letterSpacing: '1px', color: 'var(--text-muted)', marginBottom: '12px' }}>
                      COHERENCE DISTRIBUTION
                    </div>
                    <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>
                      <div style={{ fontSize: '12px' }}>
                        <span style={{ color: 'var(--accent-emerald)' }}>‚óè</span> High ({results.filter(r => r.score >= 0.6).length})
                      </div>
                      <div style={{ fontSize: '12px' }}>
                        <span style={{ color: 'var(--accent-amber)' }}>‚óè</span> Med ({results.filter(r => r.score >= 0.4 && r.score < 0.6).length})
                      </div>
                      <div style={{ fontSize: '12px' }}>
                        <span style={{ color: 'var(--text-muted)' }}>‚óè</span> Low ({results.filter(r => r.score < 0.4).length})
                      </div>
                    </div>
                  </div>
                )}
              </div>

              {/* Results */}
              <div style={{ padding: '24px 32px', overflowY: 'auto' }}>
                {loading ? (
                  <div style={{
                    display: 'flex',
                    flexDirection: 'column',
                    alignItems: 'center',
                    justifyContent: 'center',
                    height: '300px',
                    color: 'var(--text-muted)'
                  }}>
                    <div style={{
                      width: '40px',
                      height: '40px',
                      border: '3px solid var(--bg-tertiary)',
                      borderTopColor: 'var(--accent-purple)',
                      borderRadius: '50%',
                      animation: 'spin 1s linear infinite',
                      marginBottom: '16px'
                    }} />
                    <style>{`@keyframes spin { to { transform: rotate(360deg); } }`}</style>
                    Analyzing through {selectedPersona?.name} perspective...
                  </div>
                ) : results.length === 0 ? (
                  <div style={{
                    display: 'flex',
                    flexDirection: 'column',
                    alignItems: 'center',
                    justifyContent: 'center',
                    height: '300px',
                    color: 'var(--text-muted)',
                    textAlign: 'center'
                  }}>
                    <div style={{ fontSize: '48px', marginBottom: '16px', opacity: 0.5 }}>‚óà</div>
                    <div style={{ fontSize: '16px', marginBottom: '8px' }}>Select an observer</div>
                    <div style={{ fontSize: '13px' }}>Same signals. Different meanings.</div>
                  </div>
                ) : (
                  <>
                    <div style={{
                      marginBottom: '24px',
                      padding: '16px 20px',
                      background: 'var(--bg-secondary)',
                      borderRadius: '12px',
                      border: '1px solid var(--border)',
                      display: 'flex',
                      alignItems: 'center',
                      gap: '16px'
                    }}>
                      <span style={{ fontSize: '28px' }}>{selectedPersona.icon}</span>
                      <div>
                        <div style={{ fontSize: '16px', fontWeight: 600, marginBottom: '2px' }}>{selectedPersona.name}</div>
                        <div style={{ color: 'var(--text-muted)', fontSize: '12px' }}>
                          {results.length} signals ranked by observer coherence
                        </div>
                      </div>
                    </div>

                    {results.map((doc, idx) => (
                      <div
                        key={doc.id}
                        className="fade-in"
                        style={{
                          animationDelay: `${idx * 0.03}s`,
                          padding: '20px',
                          marginBottom: '12px',
                          background: 'var(--bg-secondary)',
                          borderRadius: '12px',
                          border: '1px solid',
                          borderColor: doc.score >= 0.6 ? 'rgba(16, 185, 129, 0.3)' : 'var(--border)',
                          position: 'relative',
                          overflow: 'hidden'
                        }}
                      >
                        {/* Score bar */}
                        <div style={{
                          position: 'absolute',
                          top: 0,
                          left: 0,
                          height: '3px',
                          width: `${doc.score * 100}%`,
                          background: doc.score >= 0.6 ? 'var(--accent-emerald)' : 
                                     doc.score >= 0.4 ? 'var(--accent-amber)' : 'var(--text-muted)',
                          transition: 'width 0.5s ease'
                        }} />
                        
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>
                          <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                            <span style={{
                              padding: '4px 10px',
                              background: 'var(--bg-tertiary)',
                              borderRadius: '6px',
                              fontSize: '12px',
                              fontFamily: 'JetBrains Mono',
                              color: 'var(--text-secondary)'
                            }}>
                              {doc.id}
                            </span>
                            <span style={{
                              padding: '4px 10px',
                              background: doc.source === 'SIGINT' ? 'rgba(59, 130, 246, 0.15)' :
                                         doc.source === 'HUMINT' ? 'rgba(16, 185, 129, 0.15)' :
                                         doc.source === 'SATINT' ? 'rgba(139, 92, 246, 0.15)' :
                                         'rgba(255, 255, 255, 0.1)',
                              color: doc.source === 'SIGINT' ? 'var(--accent-blue)' :
                                    doc.source === 'HUMINT' ? 'var(--accent-emerald)' :
                                    doc.source === 'SATINT' ? 'var(--accent-purple)' :
                                    'var(--text-secondary)',
                              borderRadius: '6px',
                              fontSize: '11px',
                              fontWeight: 500,
                              letterSpacing: '0.5px'
                            }}>
                              {doc.source}
                            </span>
                            <span style={{ fontSize: '12px', color: 'var(--text-muted)' }}>
                              {doc.region}
                            </span>
                          </div>
                          <div style={{
                            fontFamily: 'JetBrains Mono',
                            fontSize: '18px',
                            fontWeight: 600,
                            color: doc.score >= 0.6 ? 'var(--accent-emerald)' : 
                                  doc.score >= 0.4 ? 'var(--accent-amber)' : 'var(--text-muted)'
                          }}>
                            {doc.score.toFixed(3)}
                          </div>
                        </div>
                        <div style={{ color: 'var(--text-secondary)', fontSize: '14px', lineHeight: 1.7 }}>
                          {doc.content}
                        </div>
                      </div>
                    ))}
                  </>
                )}
              </div>
            </div>
          </div>
        );
      }

      // World Arbitration Mode
      if (mode === 'arbitration') {
        return (
          <div style={{ minHeight: '100vh', background: 'var(--bg-primary)' }}>
            {/* Header */}
            <header style={{
              padding: '20px 32px',
              borderBottom: '1px solid var(--border)',
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'space-between',
              background: 'rgba(9, 9, 11, 0.8)',
              backdropFilter: 'blur(20px)',
              position: 'sticky',
              top: 0,
              zIndex: 100
            }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                <button
                  onClick={() => { setMode(null); setArbitrationResults(null); }}
                  style={{
                    background: 'none',
                    border: 'none',
                    color: 'var(--text-secondary)',
                    cursor: 'pointer',
                    fontSize: '20px',
                    padding: '8px'
                  }}
                >
                  ‚Üê
                </button>
                <div>
                  <div style={{ fontSize: '12px', color: 'var(--text-muted)', letterSpacing: '2px' }}>
                    MODE 2
                  </div>
                  <div style={{ fontSize: '18px', fontWeight: 600 }}>
                    World Arbitration
                  </div>
                </div>
              </div>
              <div style={{ 
                fontSize: '11px', 
                color: 'var(--text-muted)', 
                fontFamily: 'JetBrains Mono',
                letterSpacing: '1px'
              }}>
                ARBITER-72D ‚Ä¢ LOCAL
              </div>
            </header>

            <div style={{ padding: '40px', maxWidth: '1200px', margin: '0 auto' }}>
              {loading ? (
                <div style={{
                  display: 'flex',
                  flexDirection: 'column',
                  alignItems: 'center',
                  justifyContent: 'center',
                  height: '400px',
                  color: 'var(--text-muted)'
                }}>
                  <div style={{
                    width: '48px',
                    height: '48px',
                    border: '3px solid var(--bg-tertiary)',
                    borderTopColor: 'var(--accent-blue)',
                    borderRadius: '50%',
                    animation: 'spin 1s linear infinite',
                    marginBottom: '20px'
                  }} />
                  <div style={{ fontSize: '16px', marginBottom: '8px' }}>Arbitrating realities...</div>
                  <div style={{ fontSize: '14px' }}>Scoring {INTELLIGENCE_CORPUS.length} signals against {HYPOTHESES.length} competing worlds</div>
                </div>
              ) : arbitrationResults ? (
                <>
                  {/* Winner Banner */}
                  <div className="fade-in" style={{
                    padding: '32px',
                    borderRadius: '16px',
                    marginBottom: '32px',
                    background: `linear-gradient(135deg, ${arbitrationResults.winner.hypothesis.color}22 0%, transparent 100%)`,
                    border: `1px solid ${arbitrationResults.winner.hypothesis.color}44`,
                    textAlign: 'center'
                  }}>
                    <div style={{ fontSize: '11px', letterSpacing: '3px', color: 'var(--text-muted)', marginBottom: '12px' }}>
                      RESOLVED WORLD STATE
                    </div>
                    <div style={{ fontSize: '32px', fontWeight: 700, marginBottom: '8px', color: arbitrationResults.winner.hypothesis.color }}>
                      {arbitrationResults.winner.hypothesis.name}
                    </div>
                    <div style={{ fontSize: '48px', fontWeight: 700, fontFamily: 'JetBrains Mono', marginBottom: '16px' }}>
                      {arbitrationResults.winner.avgScore.toFixed(4)}
                    </div>
                    <div style={{
                      display: 'inline-block',
                      padding: '8px 16px',
                      background: 'rgba(16, 185, 129, 0.15)',
                      borderRadius: '8px',
                      color: 'var(--accent-emerald)',
                      fontSize: '14px'
                    }}>
                      +{arbitrationResults.delta}% delta vs runner-up
                    </div>
                  </div>

                  {/* All Hypotheses */}
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '16px', marginBottom: '32px' }}>
                    {arbitrationResults.hypotheses.map((h, idx) => (
                      <div
                        key={h.hypothesis.id}
                        className="fade-in"
                        style={{
                          animationDelay: `${idx * 0.1}s`,
                          padding: '16px',
                          borderRadius: '10px',
                          background: 'var(--bg-secondary)',
                          border: '1px solid',
                          borderColor: idx === 0 ? h.hypothesis.color : 'var(--border)',
                          position: 'relative',
                          overflow: 'hidden'
                        }}
                      >
                        <div style={{
                          position: 'absolute',
                          top: 0,
                          left: 0,
                          right: 0,
                          height: '2px',
                          background: h.hypothesis.color
                        }} />
                        
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>
                          <div>
                            <div style={{ fontSize: '10px', color: 'var(--text-muted)', marginBottom: '2px' }}>
                              #{idx + 1}
                            </div>
                            <div style={{ fontWeight: 600, fontSize: '13px', color: h.hypothesis.color }}>
                              {h.hypothesis.name}
                            </div>
                          </div>
                          <div style={{
                            fontFamily: 'JetBrains Mono',
                            fontSize: '16px',
                            fontWeight: 600,
                            color: idx === 0 ? h.hypothesis.color : 'var(--text-secondary)'
                          }}>
                            {h.avgScore.toFixed(3)}
                          </div>
                        </div>

                        <div style={{ fontSize: '10px', color: 'var(--text-muted)', marginBottom: '6px' }}>
                          TOP SIGNAL
                        </div>
                        {h.topDocs.slice(0, 1).map((d, i) => (
                          <div key={i} style={{
                            padding: '8px',
                            background: 'var(--bg-primary)',
                            borderRadius: '6px',
                            marginBottom: '6px',
                            fontSize: '12px'
                          }}>
                            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                              <span style={{ color: 'var(--text-muted)' }}>{d.doc.id}</span>
                              <span style={{ fontFamily: 'JetBrains Mono', color: h.hypothesis.color }}>
                                {d.score.toFixed(3)}
                              </span>
                            </div>
                            <div style={{ color: 'var(--text-secondary)', lineHeight: 1.4 }}>
                              {d.doc.content.substring(0, 80)}...
                            </div>
                          </div>
                        ))}
                      </div>
                    ))}
                  </div>

                  {/* Resolution Summary */}
                  <div className="fade-in fade-in-delay-3" style={{
                    padding: '20px',
                    borderRadius: '12px',
                    background: 'var(--bg-secondary)',
                    border: '1px solid var(--border)',
                    fontFamily: 'JetBrains Mono',
                    fontSize: '12px'
                  }}>
                    <div style={{ color: 'var(--text-muted)', marginBottom: '8px' }}>
                      RESOLUTION
                    </div>
                    <div style={{ color: 'var(--text-secondary)', lineHeight: 1.6 }}>
                      {INTELLIGENCE_CORPUS.length} signals scored against {HYPOTHESES.length} competing worlds. 
                      <span style={{ color: arbitrationResults.winner.hypothesis.color }}> {arbitrationResults.winner.hypothesis.name}</span> leads by {arbitrationResults.delta}% delta.
                    </div>
                  </div>
                </>
              ) : null}
            </div>
          </div>
        );
      }

      return null;
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
